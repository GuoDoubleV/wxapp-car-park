<!--pages/payment-records/payment-records.wxml-->
<view class="payment-records-page">
  <!-- å¯¼èˆªæ  -->
  <view class="nav-bar">
    <view class="nav-left">
      <view class="nav-btn" bindtap="goBack">
        <text class="nav-icon">â†</text>
      </view>
      <view class="nav-btn" bindtap="goHome">
        <text class="nav-icon">ğŸ </text>
      </view>
    </view>
    <view class="nav-center">
      <view class="nav-title">ç¼´è´¹è®°å½•</view>
    </view>
    <view class="nav-right">
      <view class="nav-btn" bindtap="goToInvoiceRecords">
        <text class="nav-icon">ğŸ“„</text>
      </view>
      <view class="nav-btn" bindtap="showMoreOptions">
        <text class="nav-icon">â‹¯</text>
      </view>
    </view>
  </view>

  <!-- å·²é€‰æ‹©å¼€ç¥¨é‡‘é¢ -->
  <view class="selected-amount">
    å·²é€‰æ‹©å¼€ç¥¨é‡‘é¢: Â¥{{selectedAmount}}
  </view>

  <!-- ç¼´è´¹è®°å½•åˆ—è¡¨ -->
  <view class="records-list">
    <view 
      class="record-card {{selectedRecords.includes(item.id) ? 'selected' : ''}} {{item.isInvoiced ? 'invoiced' : ''}}"
      wx:for="{{paymentRecords}}"
      wx:key="id"
      bindtap="onRecordSelect"
      bindlongpress="onRecordLongPress"
      data-id="{{item.id}}"
    >
      <!-- é€‰æ‹©æ¡† -->
      <view class="select-checkbox">
        <view class="checkbox {{selectedRecords.includes(parseInt(item.id)) ? 'checked' : ''}} {{item.isInvoiced ? 'disabled' : ''}}">
          <text class="check-icon" wx:if="{{selectedRecords.includes(parseInt(item.id))}}">âœ“</text>
          <text class="disabled-icon" wx:if="{{item.isInvoiced}}">âœ•</text>
        </view>
      </view>


      <!-- è®°å½•å†…å®¹ -->
      <view class="record-content">
        <!-- è½¦ç‰Œä¿¡æ¯ -->
        <view class="plate-info">
          <view class="plate-label">è½¦ç‰Œ</view>
          <view class="plate-number">{{item.plateNumber}}</view>

        </view>

        <!-- åœè½¦è¯¦æƒ… -->
        <view class="parking-details">
          <view class="detail-item">
            <text class="detail-label">åœè½¦æ—¶é•¿:</text>
            <text class="detail-value">{{item.parkingDuration}}</text>
          </view>
          <view class="detail-item">
            <text class="detail-label">ç¼´è´¹æ—¶é—´:</text>
            <text class="detail-value">{{item.paymentTime}}</text>
          </view>
        </view>

        <!-- æ”¯ä»˜ä¿¡æ¯ -->
        <view class="payment-info">
          <view class="payment-method">{{item.paymentMethod}}</view>
          <view class="payment-amount">Â¥ {{item.amount}}</view>
        </view>
      </view>
    </view>
  </view>


  <!-- åº•éƒ¨å¼€ç¥¨æŒ‰é’® -->
  <view class="bottom-action">
    <button 
      class="invoice-btn {{selectedRecords.length > 0 ? 'active' : ''}}"
      bindtap="openInvoice"
      disabled="{{selectedRecords.length === 0}}"
    >
      å¡«å†™å¼€ç¥¨ä¿¡æ¯
    </button>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{paymentRecords.length === 0}}">
    <view class="empty-icon">ğŸ“„</view>
    <view class="empty-text">æš‚æ— ç¼´è´¹è®°å½•</view>
    <view class="empty-desc">æ‚¨çš„åœè½¦ç¼´è´¹è®°å½•å°†åœ¨è¿™é‡Œæ˜¾ç¤º</view>
  </view>

</view>
